---
layout: post
title:  "Toby's Spring Chap 09: 스프링 프로젝트 시작하기"
date:   2018-01-20
desc: "Toby's Spring Chap 09: 스프링 프로젝트 시작하기"
keywords: "spring, spring boot"
categories: [Web]
tags: [spring, spring boot]
icon: icon-html
---

스프링은 어떤 종류의 애플리케이션에 대해서도 잘 들어맞도록 매우 유연하게 설계된 범용 프레임워크이다. 그래서 아키텍처의 종류나 프로젝트를 구성하는 방법에 대한 자유도가 매우 높지만, 그만큼 구성 방법이나 아키텍처를 선택할 때 주의해야 한다.

<br>
## 자바 엔터프라이즈 플랫폼과 스프링 애플리케이션

스프링으로 만들 수 있는 애플리케이션의 종류에는 제한이 없다. **자바 언어를 사용하는 모든 종류의 프로젝트라면 어디든 사용할 수 있다.** 하지만 스프링은 주로 자바 엔터프라이즈 환경에서 동작하는 애플리케이션을 개발하는 목적으로 사용된다.

자바 엔터프라이즈 애플리케이션은 서버에서 동작하며, 클라이언트를 상대로 서비스를 제공하도록 되어 있다. 즉 클라이언트의 요청을 받아 그에 대한 작업을 수행하고, 그 결과를 돌려주는 것이 기본적인 동작 방식이다.

<br>
### 클라이언트와 백엔드 시스템

엔터프라이즈 애플리케이션은 자신이 클라이언트가 되어서 또 다른 엔터프라이즈 시스템에 서비스를 요청할 수도 있다. 가장 많이 사용되는 구조는 클라이언트가 웹 브라우저이고 백엔드 시스템이 DB인 구성이다.

스프링의 주요 기능은 웹 브라우저를 클라이언트로 하고 DB에 데이터를 저장, 조회하는데에 집중되어 있다.

> 그렇다고 해서 꼭 클라이언트가 웹 브라우저여야 하며, 백엔드 시스템은 DB를 이용해야 하는 것은 아니다. 자바가 받아들일 수 있는 요청이나 제공하는 접속 방식을 사용한다면 클라이언트나 백엔드 시스템은 무엇이든 사용할 수 있다.

<br>
![00.png](/static/assets/img/blog/web/2018-01-20-toby_spring_09_start_spring_project/00.png)

<br>
### 애플리케이션 서버

스프링으로 만든 애플리케이션을 자바 서버환경에 배포하려면 **JavaEE (또는 J2EE) 서버가 필요하다.**
JavaEE 표준을 따르는 애플리케이션 서버는 크게 두 가지로 구분할 수 있다. 

* 경량급 WAS / 서블릿컨테이너
  * 웹 모듈의 배포만 가능한 경량급 WAS 또는 서블릿/JSP 컨테이너이다. 스프링은 기본적으로 톰캣이나 제티와 같은 가벼운 서블릿 컨테이너만 있어도 충분하다. 이런 서블릿 컨테이너만으로도 엔터프라이즈 애플리케이션에 필요한 핵심기능을 모두 사용할 수 있다.
* WAS
  * 미션 크리티컬한 시스템에서 요구하는 고도의 안정성과 고성능을 요구한다면 상용 또는 오픈소스 WAS를 사용할 수도 있다.

> 스프링은 JavaEE 표준 기술을 적극적으로 지원한다.

<br>
## 애플리케이션 아키텍처

아키텍처는 여러 가지 방식으로 정의되고 이해될 수 있는 용어이다. **어떤 경계안에 있는 내부 구성요소들이 어떤 책임을 갖고 있고, 어떤 방식으로 서로 관계를 맺고 동작하는지를 규정하는 것이라고 할 수 있다.**

아키텍처는 단순히 정적인 구조를 나타내는 것으로 생각하기 쉽지만, 실제로는 그 구조에서 일어나는 **동적인 행위와 깊은 관계가 있다.**

<br>
### 계층형 아키텍처

관심, 책임, 성격, 변하는 이유와 방식이 서로 다른 것들을 분리함으로써 **분리된 각 요소의 응집도는 높여주고 서로의 결합도를 낮추는** 관심사의 분리는 아키텍처 단위로 크게 확장해볼 수도 있다.

애플리케이션을 구성하는 오브젝트들을 **비슷한 성격과 책임을 가진 것들끼리 묶을 수 있다.**

* DAO: 데이터 엑세스 로직
* 서비스: 특정 기술과 환경에 종속되지 않으며 도메인의 업무에는 밀접한 관련을 갖는 POJO 오브젝트
  * 주로 DAO를 이용해 정보의 저장과 검색을 진행하고, DB의 엔티티 모델과 유사한 도메인 오브젝트를 이용해 데이터를 주고 받는다.
* 프레젠테이션: 서블릿 컨테이너로부터 받은 사용자의 요청정보를 해석하고, POJO 기반의 서비스 오브젝트에게 전달하고, 결과를 받아 웹 사용자로 하여금 표시가능한 형태로 변환

> 오브젝트들의 단위 또한 유사한 성격을 가진 그룹별로 나누는 것이 좋다. 성격과 책임이 다른 것들이 얽혀 있으면 반드시 문제가 발생한다. 그래서 아키텍처 레벨에 대해서도 성격이 다른 것들은 분리하는 것이 좋다.

이렇게 책임과 성격이 다른 것을 크게 그룹으로 만들어 분리해두는 것을 아키텍처 차원에서는 **계층형 아키텍처**라고 부른다. 보통 웹 기반의 엔터프라이즈 애플리케이션은 3개 계층으로 분류된다.

<br>
### 3계층 아키텍처와 수직 계층

보통 다음 그림과 같이 DB나 백엔드 시스템과 연동하는 인터페이스 역할을 하는 데이터 엑세스 계층, 비즈니스 로직을 담는 서비스 계층, 웹 기반의 UI를 만들고 흐름을 관리하는 프레젠테이션 계층으로 구분한다.

<br>
![01.png](/static/assets/img/blog/web/2018-01-20-toby_spring_09_start_spring_project/01.png)

**데이터 엑세스 계층**

이 계층은 **DAO 계층**이라고도 하며, DAO 패턴을 보편적으로 사용한다. 또한 이 데이터 엑세스 계층은 DB 외에도 ERP, 레거시 시스템, 메인 프레임 등에 접근하는 역할을 하므로 EIS(Enterprise Information System) 계층이라고도 한다.

데이터 엑세스 계층은 다시 세분화된 계층으로 분류할 수도 있다. 이 계층에서 다시 세분화하는 것은 추상화 수준에 따른 구분이므로, 수직적인 계층이라고도 한다.

<br>
![02.png](/static/assets/img/blog/web/2018-01-20-toby_spring_09_start_spring_project/02.png)

위 그림과 같이 JdbcTemplate가 추상화를 위한 계층으로 사용되어 로우레벨의 기술들을 간접적으로 이용하게 만들 수 있다. 이런 수직적인 계층에서 사용자 정의 계층을 추가하면 그 계층은 **하위 계층의 변화에 대응해야 하는 책임도 가지게 된다.**

> 만약 추상 계층을 새로 추가하는 것이 부담되고, 때에 따라서는 유연하게 하위 계층의 API를 활용할 필요가 있다면 공통적인 기능을 분리하여 유틸리티나 헬퍼 메소드 또는 오브젝트로 제공하는 것도 좋은 방법이다.

**서비스 계층**

잘 만들어진 스프링 애플리케이션의 서비스 계층 클래스는 이상적인 **POJO로 작성된다.**
POJO로 만든다면 객체지향적인 설계 기법이 적용된 코드를 통해 비즈니스 로직의 핵심을 담아내고 이를 쉽게 테스트하고 유연하게 확장할 수 있다.

보통 서비스 계층은 DAO 계층을 호출하고 이를 활용해서 만들어진다. 

> 특별한 경우가 아니라면 추상화된 수직적인 계층구조를 가질 필요가 없다. 서비스 계층은 기술 API를 직접 다루지 않으므로, 기술에 일관된 방식으로 접근하거나 편하게 사용하는 추상화는 필요가 없기 때문이다.

> 시스템 레벨이나 다른 서버에서 제공하는 기반 서비스를 사용할 때도 DAO처럼 독립적인 계층의 서비스를 이용하는 것으로 봐야 한다.

<br>
![03.png](/static/assets/img/blog/web/2018-01-20-toby_spring_09_start_spring_project/03.png)

**원칙적으로는 서비스 계층 코드가 기반 서비스 계층의 구현에 종속되면 안된다.** 추상화된 서비스 인터페이스를 통해서만 접근하도록 만들어 특정 구현과 기술에 대한 종속성을 제거해야 한다.

> 이상적인 서비스 계층은 데이터 엑세스 및 프레젠테이션 계층이 모두 바뀌어도 유지될 수 있어야 한다.

**프레젠테이션 계층**

이 계층은 가장 복잡한 계층으로 매우 다양한 기술과 프레임워크의 조합을 가질 수 있다. **웹과 프레젠테이션 기술은 끊임없이 발전하고 새로운 모델이 등장하기 때문이다.**

> 보통 자바 엔터프라이즈 애플리케이션의 프레젠테이션 계층은 HTTP 프로토콜을 사용하는 서블릿이 바탕이 된다.

화면 흐름을 결정하고 입력 값에 대한 검증, 서비스 계층의 호출과 전달되는 값의 포맷의 변화, 뷰라고 불리는 화면을 어떻게 그릴지에 대한 처리를 담당한다.

스프링은 웹 기반의 프레젠테이션 계층을 개발할 수 있는 전용 웹 프레임워크를 제공한다.

---

<br>
### 계층형 아키텍처 설계의 원칙
